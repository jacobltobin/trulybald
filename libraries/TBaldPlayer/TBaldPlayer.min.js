!function(){var t=function(t,i){window[t]=i},i=function(){t("AudioPlayer",a)},a=function(t){ap=this,this.audio=new Audio,this.container=t,this.controlHandler=new n(ap),this.playHandler=new e(ap),this.tracks=$(this.container).find(".track"),this.trackIndex=0,this.playHandler.switchTrack(this.trackIndex)},n=function(t){var i=this;this.controls={play:$(t.container).find(".play-button"),next:$(t.container).find(".next-button"),prev:$(t.container).find(".previous-button"),trackPlay:$(t.container).find(".track-play-button"),timeBar:{buffer:$(t.container).find(".time-bar-buffer-background"),played:$(t.container).find(".time-bar-played-background"),handle:$(t.container).find(".time-bar-handle")}},this.controls.timeBar.nudge=function(i){this.set();var a=i?i:t.audio.currentTime/t.audio.duration*100;this.played.css("width",a+"%"),console.log(t.audio.currentTime/t.audio.duration*100)},this.controls.timeBar.set=function(){},this.controls.play.click(function(){t.playHandler.playToggle(),$(this).toggleClass("active")}),this.controls.next.click(function(){t.playHandler.goToNextTrack()}),this.controls.prev.click(function(){t.playHandler.goToPrevTrack()}),this.controls.trackPlay.click(function(){t.playHandler.switchTrack($(this).parent().index()),i.toggleActiveTrack(this),i.toggleMainPlay()}),this.toggleActiveTrack=function(t){$(this.controls.trackPlay).removeClass("active"),$(t).toggleClass("active")},this.toggleMainPlay=function(){$(this.controls.play).toggleClass("active")},this.highlightTrack=function(i){$(t.tracks).removeClass("active-track"),$(t.tracks[i]).toggleClass("active-track")}},e=function(t){this.isPlaying=!1,this.currentTrack={duration:0},t.audio.addEventListener("timeupdate",function(){t.controlHandler.controls.timeBar.nudge()}),t.audio.addEventListener("loadedmetadata",function(){}),t.audio.addEventListener("progress",function(){if(t.audio.buffered.length){var i=t.audio.buffered.end(t.audio.buffered.length-1),a=t.audio.duration;a&&a>0&&t.controlHandler.controls.timeBar.buffer.css("width",i/a*100+"%")}}),t.audio.addEventListener("ended",function(){t.playHandler.goToNextTrack()}),this.goToNextTrack=function(){t.trackIndex+=1,this.switchTrack(t.trackIndex),this.isPlaying?t.audio.play():null},this.goToPrevTrack=function(){t.trackIndex-=1,this.switchTrack(t.trackIndex),this.isPlaying?t.audio.play():null},this.switchTrack=function(i){t.trackIndex=i;var a=$(t.tracks[i]).attr("data-file");t.audio.src=a,t.controlHandler.highlightTrack(t.trackIndex)},this.playToggle=function(){this.isPlaying?t.audio.pause():t.audio.play(),this.isPlaying=!this.isPlaying}};i()}();